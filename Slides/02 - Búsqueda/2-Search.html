<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Search</title>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="../src/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="../src/reveal.js/dist/theme/black.css" id="theme"/>

<link rel="stylesheet" href="../src/style.css"/>
<link rel="stylesheet" href="../src/reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<h1 class="title">Search</h1><h2 class="date">AI - 2021 H2</h2><p class="date">Created: 2021-09-09 Thu 14:25</p>
</section>

<section>
<section id="slide-orgba8da57">
<h2 id="orgba8da57">Search Problem</h2>
<div class="outline-text-2" id="text-orgba8da57">
</div>
</section>
</section>
<section>
<section id="slide-org55852a6">
<h3 id="org55852a6">Path-finding</h3>
<p>
Many interesting problems can be framed as Search problem in a Graph.
</p>
<ul>
<li class="fragment appear">Nodes can represent specific states of a system/world/game.</li>
<li class="fragment appear">Edges represent actions that transform the state from one node into another.</li>
<li class="fragment appear">Example states:
<ul>
<li>Maze: Coordinates of the player.</li>
<li>Chess: Board position, castling state and who's to play.</li>
<li>Racing game: Points in \((t, \vec{x}, \vec{v}, \theta, \varphi, Gear, Pedals, Wheel)\).</li>
<li>Poker: Cards and chips that each player has.</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org90b3c83">
<h3 id="org90b3c83">Sokoban</h3>
</section>
<section data-background-iframe="https://www.youtube.com/embed/n9YzAK-nuB4?start=25" data-background-interactive>
</section>
</section>
<section>
<section id="slide-orgbcc6d37">
<h3 id="orgbcc6d37">Taxonomy</h3>
<ul>
<li class="fragment appear">Mode
<ul>
<li>Cooperative</li>
<li>Adversarial</li>

</ul></li>
<li class="fragment appear">Knowledge
<ul>
<li>Total</li>
<li>Partial</li>

</ul></li>
<li class="fragment appear">Determinism
<ul>
<li>Deterministic environment</li>
<li>Non-Deterministic environment</li>

</ul></li>
<li class="fragment appear">Ply (turn) time horizon
<ul>
<li>Real-time</li>
<li>Unbounded</li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org2b8aa3a">
<h3 id="org2b8aa3a">Examples</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Game</th>
<th scope="col" class="org-left">Mode</th>
<th scope="col" class="org-left">Knowledge</th>
<th scope="col" class="org-left">Determinism</th>
<th scope="col" class="org-left">Time horizon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Maze</td>
<td class="org-left">Cooperative</td>
<td class="org-left">Total</td>
<td class="org-left">Deterministic</td>
<td class="org-left">Unbounded</td>
</tr>

<tr>
<td class="org-left">Sokoban</td>
<td class="org-left">Cooperative</td>
<td class="org-left">Total</td>
<td class="org-left">Deterministic</td>
<td class="org-left">Unbounded</td>
</tr>

<tr>
<td class="org-left">Time-trial Racing</td>
<td class="org-left">Cooperative</td>
<td class="org-left">Total</td>
<td class="org-left">Deterministic</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">Freecell</td>
<td class="org-left">Cooperative</td>
<td class="org-left">Partial</td>
<td class="org-left">Non-Deterministic</td>
<td class="org-left">Unbounded</td>
</tr>
</tbody>
</table>

</section>
<section>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Game</th>
<th scope="col" class="org-left">Mode</th>
<th scope="col" class="org-left">Knowledge</th>
<th scope="col" class="org-left">Determinism</th>
<th scope="col" class="org-left">Time horizon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Racing</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Total</td>
<td class="org-left">Deterministic</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">Chess</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Total</td>
<td class="org-left">Deterministic</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">Among Us</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Partial</td>
<td class="org-left">Deterministic*</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">CS:GO</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Partial</td>
<td class="org-left">Deterministic*</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">Liar's Dice</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Partial</td>
<td class="org-left">Non-Deterministic</td>
<td class="org-left">Real-time</td>
</tr>

<tr>
<td class="org-left">Uno</td>
<td class="org-left">Adversarial</td>
<td class="org-left">Partial</td>
<td class="org-left">Non-Deterministic</td>
<td class="org-left">Real-time</td>
</tr>
</tbody>
</table>

<aside class="notes">
<p>
Enter speaker notes here.
</p>

</aside>

</section>
</section>
<section>
<section id="slide-orga027bd7">
<h3 id="orga027bd7">Problem Terminology</h3>
<p>
We will need some common terms to talk about path-finding.
</p>
<ul>
<li class="fragment appear">State: A specific configuration of a system.
<ul>
<li>Chess: The board* and who's to play.</li>

</ul></li>
<li class="fragment appear">Action: An specific action that transforms the system's State.
<ul>
<li>Chess: A move by the active player.</li>

</ul></li>
<li class="fragment appear">Search space: The space where points are system states. Related to the
<code>class</code> that represents the state.
<ul>
<li>Chess: A way of representing all chess states, like all <a href="https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation">FEN</a> positions.</li>

</ul></li>
<li class="fragment appear">Search state graph: The graph connecting states through actions.
<ul>
<li>Chess: A huge graph where edges are chess moves from one state to another.</li>

</ul></li>

</ul>

<aside class="notes">
<p>
Chess has some subtleties, like castling and draw by repetition.
</p>

</aside>

</section>
</section>
<section>
<section id="slide-org22497a2">
<h3 id="org22497a2">Search terminology</h3>
<ul>
<li class="fragment appear">Search problem: \((Space, start, goal)\)
<ul>
<li>Chess start: The state representing the starting board position.</li>
<li>Chess goal: A function that checks for check-mates</li>

</ul></li>
<li class="fragment appear">Search Tree: The spanning tree of Nodes representing paths on the State
graph. Built throughout the Search by adding Nodes or updating edges.</li>
<li class="fragment appear">Expansion: To compute the possible actions that may be performed and their
resulting states.</li>

</ul>

</section>
</section>
<section>
<section id="slide-org833946d">
<h3 id="org833946d">A generic search algorithm</h3>
<div class="org-src-container">

<pre class="fragment (appear)"><code class="python" >def generic_search_sketch(g: Graph, starting_node, goal_function) -&gt; Solution:
    Closed = set()  # Closed: Explored nodes (We only store the state)
    Open = MagicalCollection()  # Open: Known, but still unexplored Nodes
    Open.add(starting_node)

    while Open:
        node = Open.pop()  # Takes a node from Open. Which one?
        if is_goal(node):
            return path(node)

        Closed.add(node)
        for n in node.neighbors():  # Creates Nodes around node.state
            if n.state in Closed:
                continue
             Open.upsert(n)  # Insert|Update to keep Nodes a Spanning Tree (if needed)

    return None
</code></pre>
</div>


</section>
</section>
<section>
<section id="slide-org54b88fc">
<h2 id="org54b88fc">Search Algorithms</h2>
<div class="outline-text-2" id="text-org54b88fc">
</div>
</section>
</section>
<section>
<section id="slide-org7674a73">
<h3 id="org7674a73">Depth-first Search</h3>
<div class="outline-text-3" id="text-org7674a73">
</div>
</section>
<section id="slide-org28d89f8">
<h4 id="org28d89f8">A simple implementation</h4>
<div class="org-src-container">

<pre><code class="python" >def _dfs(g: Graph, state: State, q: Query, p: Path) -&gt; Path:
    """Naive-DFS. Might get stuck in a loop."""
    if q.isGoal(state):
        return p

    for s in g.neighbors(state):
        path = _dfs(g, s, q, p+s)
        if path:
            return path

    return None

def dfs(g: Graph, s: State, q: Query):
    return _dfs(g, s, q, Path())
</code></pre>
</div>

</section>
<section id="slide-org988dc4a">
<h4 id="org988dc4a">DFS v2 - Loop-safe</h4>
<div class="org-src-container">

<pre><code class="python" >def _loop_free_dfs(g: Graph, state: State, q: Query, p: Path, visited: Set[State]) -&gt; Path:
    """Simple-DFS. Checks for loops, but it might run into a Stack Overflow."""
    if q.isGoal(state):
        return g.path_to(state)  # Retrieve the path to state

    if state in visited
        return None
    visited.add(state)

    for a, s in g.neighbors(state):
        path = _loop_free_dfs(g, s, q, p+a)
        if path:
            return path

    return None

def loop_free_dfs(g: Graph, s: State, q: Query) -&gt; Path:
    return _loop_free_dfs(g, s, q, Path(), set())
</code></pre>
</div>

</section>
<section id="slide-orgb401e5e">
<h4 id="orgb401e5e">DFS v3 - Bounded stack</h4>
<div class="org-src-container">

<pre><code class="python" >def loop_free_recursion_free_dfs(g: Graph, start: State, q: Query, p: Path) -&gt; Path:
    """DFS with loop detection and no recursion. Now a Generic Search using a Stack."""
    Closed = set()
    Open = Stack()
    Open.push(start)
    g.reach(start, action=None, parent=None)

    while not Open.empty():
        state = Open.pop()

        if q.isGoal(state):
            return g.path_to(state)  # Retrieve the path to state

        for a, s in s.neighbors():
            if s in Closed:
                continue
            g.reach(s, action=a, parent=state)  # Update the path to s (if needed)
            Open.push(s)

    return None
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org57e5b39">
<h3 id="org57e5b39">Breadth-first Search</h3>
<div class="outline-text-3" id="text-org57e5b39">
</div>
</section>
<section id="slide-org5951c0f">
<h4 id="org5951c0f">A simple implementation</h4>
<div class="org-src-container">

<pre><code class="python" >def breadth_first_search(g: Graph, start: State, query: Query) -&gt; Path:
    """BFS. A Generic Search using a Queue."""
    Closed = set()
    Open = Queue()
    Open.push(start)
    g.reach(start, action=None, parent=None)

    while not Open.empty():
        state = Open.pop()

        if q.isGoal(state):
            return g.path_to(state)  # Retrieve the path to state

        for s in state.neighbors():
            if s in Closed or s in Open:
                continue
            g.reach(s, action=a, parent=state)  # Record the path to s (if needed)
            Open.push(s)

    return None
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org295e495">
<h3 id="org295e495">Dijkstra's Algorithm</h3>
<div class="outline-text-3" id="text-org295e495">
</div>
</section>
<section id="slide-org8f4adaa">
<h4 id="org8f4adaa">Graphs with costs</h4>
<ul>
<li class="fragment appear">Many problems have actions that have different costs.
<ul>
<li>Time or effort actions take varies naturally
<ul>
<li>Some roads are longer, climbing stairs takes more time and energy.</li>

</ul></li>

</ul></li>
<li class="fragment appear">BFS won't be optimal in cost by being optimal in the number of actions.</li>

</ul>

</section>
<section id="slide-org77417e4">
<h4 id="org77417e4">Solving problems with cost</h4>
<p class="fragment (appear)">
The natural starting point is BFS as it's optimal in the number of actions.
</p>
<ul>
<li class="fragment appear">How do we translate BFS's hop-consiousness into cost-consiousness?
<ul>
<li class="fragment appear">Instead of the closest node you can reach, take the cheapest one.</li>
<li class="fragment appear">Wait, is that enough? What's so smart about this? How is Dijkstra
famous for it?
<ul>
<li class="fragment appear">Yes; nothing; Invented it while drinking coffee, and also invented
many more algorithms.</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-orgb6d3a90">
<h4 id="orgb6d3a90">Updating Open</h4>
<p>
Costs will force us to continuously rank and update  nodes in \(Open\).
We will need something more efficient than a list or a stack.
</p>
<ul>
<li>A Priority Queue (aka Heap) does exactly what we need. (<a href="https://docs.python.org/3/library/heapq.html#theory">Python's heapq</a>)</li>

</ul>

</section>
<section id="slide-orgb4d8bfc">
<h4 id="orgb4d8bfc">Updating Open</h4>
<p>
What should we do here?
</p>
<ul>
<li class="fragment appear">Expansions: \((0, s), (0, b), (1, a), (4, g)\).</li>
<li class="fragment appear">Insertions/Updates: \([(0, s)], [(1, a), (0, b), (5, g)], [(7, c)], [(5\rightarrow 4, g)]\).</li>
<li class="fragment appear">Final Closed: \({s, b, a}\). Final Open: \((7, c)\). Unknown States: \(d\)</li>

</ul>

</section>
<section id="slide-org14ca1b2">
<h4 id="org14ca1b2">A simple implementation</h4>
<div class="org-src-container">

<pre><code class="python" >def best_first_search(g: Graph, start: State, query: Query) -&gt; Path:
    """Dijkstra's algorithm. Similar to BFS, but prefering lower costs."""
    Closed = set()
    Open = CustomPriorityQueue()  # A Heap with fast updates for existing items
    Open.push(Node(start))

    while not Open.empty():
        node = Open.pop()

        if q.isGoal(node.state):
            return node.get_path()

        for a, s in state.neighbors():
            if s in Closed:
                continue
            n = Node(s, action=a, parent=state)
            Open.update_if_better(n)  # Open may already have a Node for s

    return None
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-orgb725679">
<h3 id="orgb725679">Smarter decisions</h3>
<div class="outline-text-3" id="text-orgb725679">
</div>
</section>
<section id="slide-org16e223f">
<h4 id="org16e223f">Lack of comprehension</h4>
<ul>
<li class="fragment appear">Even while Dijkstra's Algorithm is aware of the costs, it still takes
decisions that humans looking at a (simple) graph wouldn't.
<ul>
<li>We make good guesses on where to head to, even if we don't exactly know
the solution for the problem.</li>

</ul></li>
<li class="fragment appear">What do we really think about when solving search problems?
<ul>
<li>We sense that some States are better than others as they seem to be
closer to the goals.</li>
<li>We estimate the remaining cost.</li>

</ul></li>

</ul>

</section>
<section id="slide-org98c99df">
<h4 id="org98c99df">What if we could estimate?</h4>
<ul>
<li class="fragment appear">Say we had a function \(estimate: State \rightarrow \mathbb{R}_0^+\)</li>
<li class="fragment appear">We could tie-break based on the estimated cost.
<ul>
<li>For equally expensive nodes from Open, we would prefer the one that
seems closer</li>

</ul></li>
<li class="fragment appear">Can we do better?</li>

</ul>

</section>
<section id="slide-org89728d9">
<h4 id="org89728d9">Rethinking costs</h4>
<p class="fragment (appear)">
With a known cost to a Node, and an estimated remaining cost to reach a goal,
we can guess what's the cost of a solution that goes the Node.
</p>
<ul>
<li class="fragment appear">Instead of only ranking with \(cost: Node \rightarrow \mathbb{R}_0^+\) we
can also consider the estimated remaining cost.
<ul>
<li class="fragment appear">\(solution\_cost: Node \rightarrow \mathbb{R}_0^+\)</li>
<li class="fragment appear">\(solution\_cost(n) = cost(n) + estimate(n.state)\)</li>
<li class="fragment appear">Actually known as \(f(n) = g(n) + h(n.state)\)</li>

</ul></li>

</ul>

</section>
<section id="slide-orgea19ec3">
<h4 id="orgea19ec3">Heuristics</h4>
<ul>
<li class="fragment appear">How do we estimate costs of a path we don't know yet?</li>
<li class="fragment appear">What if we estimate costs poorly?
<ul>
<li>What's a poor estimation?
<ul>
<li>\(h(s) = 0\) is a function from \(State \rightarrow \mathbb{R}_0^+\).
<ul>
<li>With this we are back to using Dijkstra's algorithm?</li>

</ul></li>
<li>What if we under-estimate the cost?</li>
<li>What if we over-estimate the cost?</li>
<li>Can we improve our estimations as we go?</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org38bf6dd">
<h4 id="org38bf6dd">A*</h4>
<p class="fragment (appear)">
\(A^*\) is the search algorithm that ranks nodes with \(f(n)=g(n)+h(n.state)\).
</p>
<ul>
<li class="fragment appear">Is it better? Is it the best?
<ul>
<li class="fragment appear">Well, it depends on how good the heuristic is.</li>

</ul></li>

</ul>

</section>
<section id="slide-org3e4ce58">
<h4 id="org3e4ce58">What's a good heuristic?</h4>
<ul>
<li class="fragment appear">\(h(s)=0\) is definitely not good.
<ul>
<li class="fragment appear">Not the worst, at least you fallback to Dijkstra's Algorithm, which works and gets optimal solutions.</li>
<li class="fragment appear">Really? What's worse than \(h(s)=0\)?
<ul>
<li class="fragment appear">A misguiding heuristic. What if \(h(g)=\infty\) for every goal state?
<ul>
<li class="fragment appear"><a href="https://youtu.be/vde6rOO5AbU?t=32">That's evil</a>! With that we would miss the goal!</li>
<li class="fragment appear">True. With bad heuristics \(A^*\) may not be complete nor correct.</li>

</ul></li>

</ul></li>

</ul></li>

</ul>
<ul>
<li class="fragment appear">If \(h(s)\) was the actual cost to the solution it would be really good.
<ul>
<li class="fragment appear">Indeed, but computing that is solving the search problem at hand.</li>
<li class="fragment appear">This perfect heuristic, called \(h^*(s)\), is a good reference heuristic.</li>

</ul></li>

</ul>

</section>
<section id="slide-orgc067fd7">
<h4 id="orgc067fd7">So, what's a good heuristic?</h4>
<ul>
<li class="fragment appear">A good heuristic must not drive us away from a goal.
<ul>
<li class="fragment appear">\(0 \leq h(s) \leq h^*(s)\)
<ul>
<li class="fragment appear">Global property that ensures \(f(n)\) is always be a lower bound for the cost.</li>
<li class="fragment appear">Otherwise we may defer expanding nodes in the optimal path for too
long and find a sub-optimal path first.</li>
<li class="fragment appear">Known as admissibility.</li>

</ul></li>
<li class="fragment appear">Is this enough?
<ul>
<li>No :(</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org679d132">
<h4 id="org679d132">A stronger heuristic property</h4>

<div id="org45686e5" class="figure">
<p><img src="../src/Graphs/search_inconsistent_h.png" alt="search_inconsistent_h.png" />
</p>
</div>

<ul>
<li class="fragment appear">\(A^*\) finds \([S, B, G]\) with cost \(5\), which is suboptimal.
<ul>
<li>Please see it by yourself.</li>

</ul></li>
<li class="fragment appear">This heuristic is admissible and almost \(h^*(s)\), it only differs on \(B\).
<ul>
<li class="fragment appear">\(A^*\) gets misdirected. What's so wrong with \(h(B)=0\)?
<ul>
<li>It tells us that \(B\) is really good and \(B\) gets in \(Closed\) too early.</li>
<li>When we expand \(A\) we could notice there's something odd.</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org618700d">
<h4 id="org618700d">Consistency</h4>

<div id="org5fb99b4" class="figure">
<p><img src="../src/Graphs/search_inconsistent_h.png" alt="search_inconsistent_h.png" />
</p>
</div>
<ul>
<li class="fragment appear">The oddity must be on \(h(B)=0\). On other states \(h=h^*\).
<ul>
<li class="fragment appear">BFS and Dijkstra expand nodes with non-decreasing steps / cost.</li>
<li class="fragment appear">But this glitch in \(h(B)\) makes \(f(S)=4\) drop down to \(f(B)=3\)</li>

</ul></li>
<li class="fragment appear">Consistency:
<ul>
<li class="fragment appear">Local property that justifies h(s) considering the successors of \(s\).</li>
<li class="fragment appear">\(h(n) \leq c(n, a, n') + h(n')\)</li>
<li class="fragment appear">\(g(n) + h(n) \leq g(n) + c(n, a, n') + h(n')\)</li>
<li class="fragment appear">\(f(n) \leq f(n')\)</li>

</ul></li>

</ul>

</section>
<section id="slide-org5e8cc24">
<h4 id="org5e8cc24">Optimality</h4>
<ul>
<li class="fragment appear">Is \(A^*\) finally optimal when using a consistent heuristic?
<ul>
<li class="fragment appear">Yes, and we can get a slightly more general result for free.</li>
<li class="fragment appear">w-\(A^*\) is w-optimal.
<ul>
<li class="fragment appear">\(f_w(n) = g(s) + w*h(n)\) produces solutions no more than \(w\) times
more expensive than the optimal.</li>
<li class="fragment appear">This makes the fringe deform even further towards the goals.</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org7caa196">
<h4 id="org7caa196">Engineering heuristics</h4>
<ul>
<li class="fragment appear">We can disassemble a problem without affecting the heuristic properties.
<ul>
<li class="fragment appear">Removing an action/edge keeps a heuristic admissible.</li>
<li class="fragment appear">Removing an action/edge keeps a heuristic consistent.</li>

</ul></li>
<li class="fragment appear">Can we devise a problem with more actions and solve it perfectly?
<ul>
<li class="fragment appear">This problem is called a relaxation.</li>
<li class="fragment appear">Solving it with a consistent heuristic, like \(h^*\) would give us a
consistent (and admissible) heuristic for our actual problem.</li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-org73abc35">
<h3 id="org73abc35">Designing heuristics</h3>
<div class="outline-text-3" id="text-org73abc35">
</div>
</section>
<section id="slide-orgb6ae9f3">
<h4 id="orgb6ae9f3">2D-grid</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">üßç</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">üèÅ</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-org9f3e860">
<h4 id="org9f3e860">8-puzzle</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">8</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">7</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>

<p>
<a href="https://murhafsousli.github.io/8puzzle/">Online 8-Puzzle</a>
</p>

</section>
<section id="slide-org25a1aa3">
<h4 id="org25a1aa3">Sokoban</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">üßç</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">‚òê</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">üß±</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">‚òê</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">üß±</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">üì¶</td>
<td class="org-left">üì¶</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section data-background-iframe="https://www.youtube.com/embed/n9YzAK-nuB4?start=25" data-background-interactive>

</section>
<section id="slide-org2a3bd62">
<h4 id="org2a3bd62">Sudoku</h4>

<div id="org12893c7" class="figure">
<p><img src="../src/Images/sudoku.png" alt="sudoku.png" />
</p>
</div>

</section>
<section id="slide-orgd617806">
<h4 id="orgd617806">Unblock-me</h4>

<div id="org793c279" class="figure">
<p><img src="./../src/Images/unblock-me.png" alt="unblock-me.png" />
</p>
</div>

</section>
<section id="slide-org7ad8c0b">
<h4 id="org7ad8c0b">Parking lot</h4>
</section>
<section data-background-iframe="https://www.youtube.com/embed/CMKbmmehgj8" data-background-interactive>

</section>
</section>
<section>
<section id="slide-org0bda300">
<h3 id="org0bda300">Topics in Search</h3>
<div class="outline-text-3" id="text-org0bda300">
</div>
</section>
<section id="slide-org19191a7">
<h4 id="org19191a7">Iterative deepening</h4>
<ul>
<li>Most search trees grow exponentially as their depth increases.
<ul>
<li>Without \(h^*\), no matter how we choose, we will run into huge trees.</li>
<li>Can we explore the search tree without generating too many nodes?
<ul>
<li>Memory is slow</li>
<li>CPUs are super fast, we will likely be bounded by the CPU cache and
main memory speeds.</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-orged8fe58">
<h4 id="orged8fe58">Iterative deepening</h4>
<div class="org-src-container">

<pre class="fragment (appear)"><code class="python" >def generic_search_sketch(g: Graph, starting_node, goal_function, limit) -&gt; Solution:
    Closed = set()  # Closed: Explored nodes (We only store the state)
    Open = MagicalCollection()  # Open: Known, but still unexplored Nodes
    Open.add(starting_node)

    while Open:
        node = Open.pop()  # Takes a node from Open. Which one?
        if node.cost &gt; limit:
            continue
        if is_goal(node):
            return path(node)
        Closed.add(node)
        for n in node.neighbors():  # Creates Nodes around node.state
            if n.state in Closed:
                continue
             Open.upsert(n)  # Insert|Update to keep Nodes a Spanning Tree (if needed)

    return None

def generic_search_sketch(g: Graph, starting_node, goal_function) -&gt; Solution:
    limit = 1
    while True:
        sol = generic_search(g, starting_node, goal_function, limit)
        if sol is not None:
            return sol

        limit += # ???
</code></pre>
</div>

</section>
<section id="slide-org33846ec">
<h4 id="org33846ec">Monte-Carlo tree search</h4>
<ul>
<li>What if simulating games was cheaper than thinking?
<ul>
<li>We could play randomly and remember the best solutions so far
<ul>
<li>Early cut-off</li>
<li>Having a solution ready early on
<ul>
<li>If we run out of time we'll probably have something.</li>

</ul></li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org57c48e0">
<h4 id="org57c48e0">Online search</h4>
<ul>
<li>Interleaving thinking and acting.
<ul>
<li>Does this really work?
<ul>
<li>How to avoid loops?</li>

</ul></li>
<li>Can we learn across search iterations?</li>

</ul></li>
<li>When can we effectively do this?
<ul>
<li>What if some actions were irreversible?</li>

</ul></li>

</ul>

</section>
<section id="slide-org59364e3">
<h4 id="org59364e3">Online Search - The bad parts</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">S</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-orgd66d546">
<h4 id="orgd66d546">Online Search - The bad parts</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">X</td>
<td class="org-left">x</td>
<td class="org-left">X</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">S</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-org696e899">
<h4 id="org696e899">Online Search - The bad parts</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">s</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-org00dbc82">
<h4 id="org00dbc82">Online Search - The bad parts</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">s</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">X</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">-</td>
<td class="org-left">X</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">x</td>
<td class="org-left">X</td>
<td class="org-left">-</td>
<td class="org-left">X</td>
<td class="org-left">x</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">x</td>
<td class="org-left">X</td>
<td class="org-left">x</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">x</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-orgad24899">
<h4 id="orgad24899">Online Search - The bad parts</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">G</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">S</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">#</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

</section>
</section>
<section>
<section id="slide-org81a0483">
<h2 id="org81a0483">Adversarial Search</h2>
<div class="outline-text-2" id="text-org81a0483">
</div>
</section>
</section>
<section>
<section id="slide-org800641b">
<h3 id="org800641b">What is adversarial search?</h3>
<div class="outline-text-3" id="text-org800641b">
</div>
</section>
<section id="slide-org72571d6">
<h4 id="org72571d6">A planned disruption</h4>
<ul>
<li class="fragment appear">So far we have studied methods to solve games where everything is under control
<ul>
<li class="fragment appear">We make every move</li>
<li class="fragment appear">We completely understand and know the consequences of our actions</li>
<li class="fragment appear">We can take as long as we need</li>

</ul></li>
<li class="fragment appear">What if we are not the only agent?
<ul>
<li class="fragment appear">Games against other smart agents</li>
<li class="fragment appear">Games against chance</li>

</ul></li>

</ul>

</section>
<section id="slide-orga212da8">
<h4 id="orga212da8">Playing against adversaries</h4>
<ul>
<li class="fragment appear">How do we play chess?
<ul>
<li class="fragment appear">We need to know how we and our opponents will play.</li>
<li class="fragment appear">They need to know how we will play too. There's some symmetry.</li>

</ul></li>

</ul>

</section>
<section id="slide-org37ff992">
<h4 id="org37ff992">Game trees</h4>

<div id="org9d8ff1b" class="figure">
<p><img src="./../src/Images/tic-tac-toe.png" alt="tic-tac-toe.png" />
</p>
</div>

</section>
<section id="slide-org5479875">
<h4 id="org5479875">Representing games</h4>
<ul>
<li class="fragment appear">If we ever played tic-tac-toe, we thought about that tree before.
<ul>
<li class="fragment appear">But what is really that tree?</li>

</ul></li>

</ul>

</section>
<section id="slide-org4dc4c20">
<h4 id="org4dc4c20">Game elements</h4>
<ul>
<li class="fragment appear">Space: The space of configurations of the problem and the actions.
<ul>
<li class="fragment appear">Players: This is new, just a list of players.</li>
<li class="fragment appear">State: A specific state of the game.
<ul>
<li class="fragment appear">Active player: Who is to take an action.</li>
<li class="fragment appear">Actions: The actions that the active player can take and their
outcome.</li>

</ul></li>

</ul></li>
<li class="fragment appear">Problem: The game to play on the Space
<ul>
<li class="fragment appear">Initial State: Where to start from. This includes the starting player.</li>
<li class="fragment appear">Terminal test: A predicate that tells us that the game ended.</li>
<li class="fragment appear">Utility: A function \(state, player \to \mathbb{R}\) that tells us the
outcomes for each player.</li>

</ul></li>

</ul>

</section>
<section id="slide-org5a0d62a">
<h4 id="org5a0d62a">Minimax</h4>
<div class="org-src-container">

<pre><code class="python" >def minimax(state: State) -&gt; (Action, Score):
    """Selects the action with the best worst-case.

    If our (only) opponent plays perfectly, we maximize our value.
    """
    best_action = None
    best_value = float("-inf")

    for (a, s) in state.neighbors():
        state_value = min_value(s)
        if state_value &gt; best_value:
            best_value = state_value
            best_action = a
    return (best_action, best_value)
</code></pre>
</div>

</section>
<section id="slide-orge4b75be">
<h4 id="orge4b75be">Minimax helpers</h4>
<div class="org-src-container">

<pre><code class="python" >def max_value(state: State) -&gt; Score:
    """The best outcome we can get."""
    if problem.is_terminal(state):
        return problem.linearized_utility(state)

    best_value = float("-inf")
    for (a, s) in state.neighbors():
        best_value = max(best_value, min_value(s))
    return best_value

def min_value(state: State) -&gt; Score:
    """The worst outcome we may face."""
    if problem.is_terminal(state):
        return problem.linearized_utility(state)

    worst_value = float("inf")
    for (a, s) in state.neighbors():
        worst_value = min(worst_value, max_value(s))
    return worst_value
</code></pre>
</div>

</section>
<section id="slide-orga0c950b">
<h4 id="orga0c950b">Minimax limitations</h4>
<ul>
<li class="fragment appear">Minimax never estimates the future moves, it just computes and check them.</li>
<li class="fragment appear">Exploring the entire search space is too expensive
<ul>
<li class="fragment appear">We don't play games like this!</li>

</ul></li>

</ul>

</section>
<section id="slide-org291867e">
<h4 id="org291867e">Improving the search</h4>
<ul>
<li>Trim actions that won't be played
<ul>
<li>If a player has a good move, why analyze lesser moves?</li>

</ul></li>
<li>Limit the analysis depth by estimating the value of the states.
<ul>
<li>Many games have infinite game trees. This is a hard requirement.
<ul>
<li>Chess has some special rules to declare draws.</li>

</ul></li>

</ul></li>
<li>Rank actions
<ul>
<li>Prioritizing good moves improves trimming.</li>

</ul></li>

</ul>

</section>
<section id="slide-org85093e7">
<h4 id="org85093e7">Alpha-beta pruning</h4>
<div class="org-src-container">

<pre><code class="python" >def alpha_beta_pruning(state: State) -&gt; (Action, Score):
    """Selects the action with the best worst-case.

    If our (only) opponent plays perfectly, we maximize our value.
    s: The state to analyse
    a: The value of our best move.
    b: The value of our opponent's worst move.
    """
    best_action = None
    best_value = float("-inf")

    for (a, s) in state.neighbors():
        state_value = max_value(s,
                                alpha=float("-inf"), # We lose
                                beta=float("inf"))   # They lose
        if state_value &gt; best_value:
            best_value = state_value
            best_action = a
    return (best_action, best_value)
</code></pre>
</div>

</section>
<section id="slide-orgbf1fee8">
<h4 id="orgbf1fee8">Alpha-beta pruning helpers</h4>
<div class="org-src-container">

<pre><code class="python" >def max_value(state: State, alpha: Score, beta: Score) -&gt; Score:
    """The best outcome we can get."""
    if problem.is_terminal(state):
        return problem.linearized_utility(state)

    best_value = float("-inf")
    for (a, s) in state.neighbors():
        best_value = max(best_value, min_value(s, alpha_beta))
        if best_value &gt;= beta:  # Our opponent already has a better move
            return best_value
        alpha = max(alpha, best_value)
    return best_value

def min_value(state: State, alpha: Score, beta: Score) -&gt; Score:
    """The worst outcome we may face."""
    if problem.is_terminal(state):
        return problem.linearized_utility(state)

    worst_value = float("inf")
    for (a, s) in state.neighbors():
        worst_value = min(worst_value, max_value(s, alpha, beta))
        if worst_value &lt;= alpha:  # We already have a better move
            return worst_value
        beta = min(beta, worst_value)
    return worst_value
</code></pre>
</div>

</section>
<section id="slide-orgeb73b34">
<h4 id="orgeb73b34">Estimating value</h4>
<ul>
<li class="fragment appear">How can we guess the value of a state without exploring the following moves?
<ul>
<li class="fragment appear">This plays the same role as heuristics, but what's a good estimation here?</li>

</ul></li>
<li class="fragment appear">This is problem specific, but it should relate to the chances of winning.
<ul>
<li class="fragment appear">e.g.: Chess: Consider power of each player's pieces, a measure of board control.</li>

</ul></li>
<li class="fragment appear">When do we resort to estimates?
<ul>
<li class="fragment appear">Add a hard-limit to depth. We want a known bound to keep the search finite.</li>
<li class="fragment appear">Can we dynamically adjust the depth limit based on the state?
<ul>
<li>This needs problem-specific knowledge and experimentation.</li>

</ul></li>

</ul></li>
<li class="fragment appear">How do we implement this?
<ul>
<li class="fragment appear">Right after checking for terminal states so we don't explore any further.</li>

</ul></li>

</ul>

</section>
<section id="slide-orga24ff02">
<h4 id="orga24ff02">Ranking actions</h4>
<p>
In which order do we explore the actions? How do we rank them?
</p>
<ul>
<li class="fragment appear">We may statically rank actions by how powerful they usually are.
<ul>
<li class="fragment appear">e.g.: Chess: Capturing pieces, checks</li>

</ul></li>
<li class="fragment appear">We may rank actions by estimating the value of the states they get to.
<ul>
<li class="fragment appear">This is more dynamic and just reuses the estimating function.</li>

</ul></li>
<li class="fragment appear">Do we need to explore every action?
<ul>
<li class="fragment appear">What if an action ranks too poorly?</li>
<li class="fragment appear">We can just drop actions just based on our estimation.</li>

</ul></li>

</ul>

</section>
<section id="slide-org65b76bb">
<h4 id="org65b76bb">Further tricks</h4>
<p>
Can we analyze the game beforehand?
</p>
<ul>
<li class="fragment appear">Many chess engines resort to opening databases
<ul>
<li class="fragment appear">These store good estimates of in-depth analysis. Essentially a cache.</li>

</ul></li>
<li class="fragment appear">Can we capture evaluation knowledge and use it in new searches?
<ul>
<li class="fragment appear">Just throw-in some ML to build a circuit (NN) that precisely and
concisely evaluates positions from in-depth offline analysis.
<ul>
<li class="fragment appear">We can learn our state evaluation function.</li>
<li class="fragment appear">We can learn our action ranking and pruning function.</li>
<li class="fragment appear">We can learn our search cut-off function.</li>

</ul></li>

</ul></li>

</ul>
</section>
</section>
</div>
</div>
<script src="../src/reveal.js/dist/reveal.js"></script>
<script src="../src/reveal.js/plugin/highlight/highlight.js"></script>
<script src="../src/reveal.js/plugin/markdown/markdown.js"></script>
<script src="../src/reveal.js/plugin/notes/notes.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'h.v',
rollingLinks: true,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,
overview: true,
width: 1366,
height: 768,

transition: 'slide',
transitionSpeed: '2',

// Plugins with reveal.js 4.x
plugins: [ RevealHighlight, RevealMarkdown, RevealNotes ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
